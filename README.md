# Latte_Compiler
A Haskell written Complier for Latte language, done for compiler construction course 

## Running the interpreter

You can run the compile and run the compiler using following commands:
```
make
./latc file_name.lat
```
More information can be found by typing
```
make
./latc -h
```

## Frontend structure & description
***
There are three main folders inside the frontend part of the compiler:
- **Lang**
    Lang folder stores the Latte.cf file which describes the syntax of a latte program.
    The grammar is written using BNFC and the file is later used to generate parser files.
- **Parser**
    Parser stores all autogenerated (by BNFC, alex and happy) files, which are used to parse the
    program, check for syntax errors and return a program tree.
- **Synthesis**
    Synthesis consists of three stages, each represented by one of the main file, Ast, Typecheck
    and Optimizer. Ast stores and converts the bnfc program tree into my own structure which optimizes
    some syntax constructors (swapping a for loop to a while, changing increment and decrement to regular
    operations etc.) Typecheck is mainly responsible for checking program correctness as well as doing some
    minor changes in ast. Lastly there is an optimizer, which removes dead code and folds the constants.

## Brief description :zap:
***
Interpreter analyzes passed code in three phases:
- **Syntax check and tokenizing**
    - Checks whether the code can be generated using grammar from Tempest.cf file.
    - Converts the string into a tree of non-terminal symbols.
    - Possible non-terminals are located inside AbsTempest.hs file.  
    - This part is mostly done by autogenerated files based on a given grammar. Files that
        operate in this phase are located in src/Syntax folder.
- **Typechecker**
    - This phase is responsible for correct static typing of program.
    - Typechecker analyzes a given program, throwing an exception to stderr if it has any errors.
    - All possible exception types can be found in TypecheckerData.hs file.
    - All files of this part are located inside src/Typecheck folder.
- **Interpreter**
    - Main phase of the whole project, which evaluates the given program.
    - Interpreter may throw runtime exceptions, such as division by zero or no return encountered exceptions.
    - Files regarding this part are stationed in src/Interpret folder.
    
## Used tools and libraries
***
Compiler uses BNFC as a grammar tool and alex + happy for parser generations.
There aren't any unusual libraries in the code, most of them are related to data structures 
(Map, Set, List) or Monads (ExceptT, ReaderT, StateT, IO).

## Built-in functions
***    
Compiler has five pre-defined functions:
- error(), which throws an error called runtime exception, effectively stopping the program from further execution,
- printInt(i), which prints a given integer to stdin,
- printString(i), which prints a given string to stdin (note that you can concatenate strings using +++ sign),
- readInt(), which reads an int from stdin,
- readString(), which reads a string (line) from stdin.

There are also three pre-defined classes:
- Object, which is a parent of all classes and has an 'equals' method,
- Array, which is a class used for representing arrays - This class elements are immutable,
- String, which is a class equivalent of string primitive type and has a 'concat' method.
